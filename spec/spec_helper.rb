require 'selenium-webdriver'

# This file was generated by the `rspec --init` command. Conventionally, all
# specs live under a `spec` directory, which RSpec adds to the `$LOAD_PATH`.
# Require this file using `require "spec_helper"` to ensure that it is only
# loaded once.
#
# See http://rubydoc.info/gems/rspec-core/RSpec/Core/Configuration
RSpec.configure do |config|
  config.treat_symbols_as_metadata_keys_with_true_values = true
  config.run_all_when_everything_filtered = true
  config.filter_run :focus

  # Run specs in random order to surface order dependencies. If you find an
  # order dependency and want to debug it, you can fix the order by providing
  # the seed, which is printed after each run.
  #     --seed 1234
  config.order = 'random'

  include Selenium::WebDriver


  capabilities = {
      'device' => 'Android',
      'browserName' => '',
      'version' => '4.2',
      'app' => '/home/joan/workspace/appium-experiment/any_do.apk',
      'app-package' => 'com.xuchdeid.clear',
      'app-activity' => '.activity.ClearActivity'
  }

  server_url = "http://127.0.0.1:4723/wd/hub"

  config.before :all do
    @driver = Selenium::WebDriver.for(:remote, :desired_capabilities => capabilities, :url => server_url)
    @driver.manage.timeouts.implicit_wait = 20 # seconds
    @driver.find_element(:name, 'Skip').click

    accept_button = @driver.find_element(:name, 'Accept')
    accept_button.click
    puts "BUTTON #{accept_button}".yellow
   end

  config.after :all do
    @driver.quit
  end

end
